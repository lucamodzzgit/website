<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>FREE HUB ‚Äì Downloads</title>
  <meta name="description" content="Kostenlose Downloads & Tools (Demo). Modernes Darkmode-Layout mit Karten, Suche, Kategorien und FAQ." />

  <!-- YAML parser (for Markdown frontmatter) -->
  <script defer src="https://unpkg.com/js-yaml@4.1.0/dist/js-yaml.min.js"></script>

  <style>
    :root{
      --bg:#070a0f;
      --panel:rgba(255,255,255,.06);
      --panel2:rgba(255,255,255,.09);
      --text:#eaf0ff;
      --muted:rgba(234,240,255,.72);
      --border:rgba(255,255,255,.12);
      --accent:#7c5cff;
      --accent2:#00d4ff;
      --danger:#ff4d6d;
      --shadow:0 18px 60px rgba(0,0,0,.58);
      --radius:18px;
      --radius2:22px;
      --max:1140px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      color:var(--text);
      background:
        radial-gradient(900px 400px at 20% 10%, rgba(124,92,255,.25), transparent 60%),
        radial-gradient(700px 360px at 85% 20%, rgba(0,212,255,.18), transparent 55%),
        radial-gradient(650px 420px at 40% 92%, rgba(124,92,255,.12), transparent 60%),
        var(--bg);
      overflow-x:hidden;
    }
    a{color:inherit;text-decoration:none}
    .container{max-width:var(--max);margin:0 auto;padding:0 18px}
    .sr-only{position:absolute;left:-9999px;width:1px;height:1px;overflow:hidden}

    /* Topbar */
    .topbar{
      position:sticky;top:0;z-index:50;
      backdrop-filter: blur(14px);
      background: rgba(7,10,15,.62);
      border-bottom:1px solid var(--border);
    }
    .nav{
      display:flex;align-items:center;justify-content:space-between;
      padding:14px 0;gap:12px;
    }
    .brand{
      display:flex;align-items:center;gap:10px;
      font-weight:900;letter-spacing:.3px;
    }
    .logo{
      width:34px;height:34px;border-radius:12px;
      background:
        radial-gradient(10px 10px at 30% 30%, rgba(255,255,255,.9), transparent 55%),
        linear-gradient(135deg,var(--accent),var(--accent2));
      box-shadow:0 10px 28px rgba(124,92,255,.25);
      overflow:hidden;
      display:grid;
      place-items:center;
      flex:0 0 auto;
    }
    .logo img{width:100%;height:100%;object-fit:cover;display:block}
    .pill{
      font-size:12px;padding:4px 10px;border-radius:999px;
      border:1px solid var(--border);
      background:rgba(255,255,255,.04);
      color:var(--muted);
    }
    .navlinks{display:flex;align-items:center;gap:10px;flex-wrap:wrap;justify-content:flex-end}
    .navlinks a{
      padding:10px 12px;border-radius:12px;
      color:var(--muted);
      border:1px solid transparent;
    }
    .navlinks a:hover{color:var(--text);border-color:var(--border);background:rgba(255,255,255,.04)}
    .navlinks a.active{
      color:var(--text);
      border-color:rgba(124,92,255,.35);
      background:rgba(124,92,255,.12);
    }

    /* Buttons */
    .btn{
      display:inline-flex;align-items:center;justify-content:center;gap:10px;
      padding:12px 14px;border-radius:14px;border:1px solid var(--border);
      background:rgba(255,255,255,.04);color:var(--text);
      cursor:pointer;
      transition:transform .12s ease, background .12s ease, border-color .12s ease, box-shadow .12s ease;
      user-select:none;white-space:nowrap;
    }
    .btn:hover{
      transform: translateY(-1px);
      background: rgba(255,255,255,.06);
      border-color: rgba(255,255,255,.18);
      box-shadow: 0 10px 28px rgba(0,0,0,.25);
    }
    .btn.primary{
      border-color:rgba(124,92,255,.55);
      background: linear-gradient(135deg, rgba(124,92,255,.25), rgba(0,212,255,.12));
      box-shadow: 0 18px 46px rgba(124,92,255,.18);
    }
    .btn.primary:hover{
      border-color: rgba(0,212,255,.45);
      background: linear-gradient(135deg, rgba(124,92,255,.30), rgba(0,212,255,.16));
    }
    .btn.small{padding:10px 12px;border-radius:12px;font-size:14px}
    .btn.ghost{background:transparent}
    .btn:disabled{opacity:.6;cursor:not-allowed;transform:none;box-shadow:none}

    /* Hero */
    .hero{padding:46px 0 18px}
    .heroGrid{
      display:grid;
      grid-template-columns: 1.25fr .75fr;
      gap:18px;
      align-items:stretch;
    }
    .heroCard{
      border:1px solid var(--border);
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
      border-radius: var(--radius2);
      box-shadow: var(--shadow);
      overflow:hidden;
      position:relative;
    }
    .heroCard::before{
      content:"";
      position:absolute; inset:-2px;
      background:
        radial-gradient(500px 220px at 20% 10%, rgba(124,92,255,.25), transparent 60%),
        radial-gradient(400px 200px at 85% 20%, rgba(0,212,255,.18), transparent 55%);
      pointer-events:none;
      filter: blur(10px);
      opacity:.9;
    }
    .heroInner{position:relative;padding:26px}
    .hTitle{
      font-size: clamp(28px, 3.5vw, 46px);
      line-height: 1.04;
      margin:0 0 10px;
      letter-spacing: -0.02em;
    }
    .hTitle b{
      background: linear-gradient(135deg, #ffffff, rgba(255,255,255,.55));
      -webkit-background-clip:text; background-clip:text;
      -webkit-text-fill-color:transparent;
    }
    .hTitle .glow{
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      -webkit-background-clip:text; background-clip:text;
      -webkit-text-fill-color:transparent;
      text-shadow: 0 0 24px rgba(124,92,255,.25);
    }
    .hSub{margin:0 0 16px;color:var(--muted);max-width:70ch}
    .heroActions{display:flex;gap:10px;flex-wrap:wrap}
    .heroMeta{display:flex;gap:10px;flex-wrap:wrap;margin-top:16px}
    .chip{
      font-size:13px;
      color:rgba(234,240,255,.78);
      border:1px solid var(--border);
      background:rgba(255,255,255,.04);
      padding:8px 10px;
      border-radius:999px;
    }

    /* Notice */
    .notice{
      margin-top:14px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.04);
      border-radius: 16px;
      padding:12px 12px;
      display:flex;gap:10px;align-items:flex-start;
      color: rgba(234,240,255,.8);
    }
    .notice b{color:var(--text)}
    .notice .dot{
      width:10px;height:10px;border-radius:999px;margin-top:5px;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      box-shadow: 0 0 18px rgba(124,92,255,.35);
      flex:0 0 auto;
    }

    /* Side card */
    .sideCard{
      border:1px solid var(--border);
      background: rgba(255,255,255,.05);
      border-radius: var(--radius2);
      overflow:hidden;
    }
    .sideInner{padding:20px}
    .sideTitle{margin:0 0 8px;font-size:16px}
    .sideText{margin:0 0 14px;color:var(--muted);font-size:14px}
    .search{
      display:flex;gap:10px;
      border:1px solid var(--border);
      background: rgba(255,255,255,.04);
      border-radius:14px;
      padding:10px;
      align-items:center;
    }
    .search input{
      width:100%;
      border:0; outline:0;
      background: transparent;
      color: var(--text);
      font-size:14px;
    }
    .filters{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
    select{
      appearance:none;
      border:1px solid var(--border);
      background: rgba(255,255,255,.04);
      color: var(--text);
      padding:10px 12px;
      border-radius:14px;
      outline:none;
      width:100%;
    }
    .row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    .hint{
      margin-top:12px;
      font-size:13px;
      color: var(--muted);
      line-height:1.35;
    }

    /* Sections */
    .section{padding:16px 0 52px}
    .sectionHead{
      display:flex;
      align-items:end;
      justify-content:space-between;
      gap:14px;
      flex-wrap:wrap;
      margin: 10px 0 14px;
    }
    .sectionHead h2{margin:0;font-size:18px;letter-spacing:.2px}
    .sectionHead p{margin:0;color:var(--muted);font-size:14px}

    /* Cards grid */
    .grid{display:grid;grid-template-columns:repeat(3, minmax(0,1fr));gap:14px}
    .card{
      border:1px solid var(--border);
      background: rgba(255,255,255,.05);
      border-radius: var(--radius);
      overflow:hidden;
      transition: transform .14s ease, border-color .14s ease, background .14s ease;
      box-shadow: 0 18px 40px rgba(0,0,0,.25);
    }
    .card:hover{transform:translateY(-3px);border-color:rgba(124,92,255,.35);background:rgba(255,255,255,.06)}
    .thumb{
      aspect-ratio:16/9;
      width:100%;
      background:
        radial-gradient(400px 200px at 15% 20%, rgba(124,92,255,.35), transparent 60%),
        radial-gradient(320px 160px at 85% 30%, rgba(0,212,255,.25), transparent 58%),
        linear-gradient(135deg, rgba(255,255,255,.08), rgba(255,255,255,.03));
      border-bottom:1px solid var(--border);
      position:relative;
      overflow:hidden;
    }
    .thumb img{width:100%;height:100%;object-fit:cover;display:block;filter:saturate(1.05) contrast(1.02)}
    .badge{
      position:absolute;left:12px;top:12px;
      font-size:12px;padding:6px 10px;border-radius:999px;
      border:1px solid rgba(255,255,255,.18);
      background:rgba(0,0,0,.25);
      color:rgba(234,240,255,.85);
      backdrop-filter: blur(8px);
    }
    .cardBody{padding:14px}
    .cardTitle{margin:0 0 6px;font-size:16px}
    .cardDesc{margin:0 0 12px;color:var(--muted);font-size:14px;line-height:1.35}
    .cardActions{display:flex;gap:10px;flex-wrap:wrap}

    /* Tabs */
    .tabs{display:flex;gap:10px;flex-wrap:wrap}
    .tabBtn[aria-selected="true"]{border-color:rgba(124,92,255,.45);background:rgba(124,92,255,.12);color:var(--text)}
    .tabPanel{display:none}
    .tabPanel.active{display:block}

    /* FAQ */
    .faq{
      border:1px solid var(--border);
      background: rgba(255,255,255,.05);
      border-radius: var(--radius2);
      overflow:hidden;
    }
    details{border-top:1px solid var(--border)}
    details:first-child{border-top:0}
    summary{
      cursor:pointer;
      padding:16px 16px;
      list-style:none;
      display:flex;align-items:center;justify-content:space-between;gap:12px;
    }
    summary::-webkit-details-marker{display:none}
    summary span{font-weight:650}
    .faq p{margin:0;padding:0 16px 16px;color:var(--muted);line-height:1.45}
    .caret{
      width:10px;height:10px;border-right:2px solid rgba(234,240,255,.8);border-bottom:2px solid rgba(234,240,255,.8);
      transform:rotate(45deg);transition:transform .15s ease;
    }
    details[open] .caret{transform:rotate(225deg)}

    /* Footer */
    footer{
      border-top:1px solid var(--border);
      background: rgba(0,0,0,.18);
      padding:22px 0 36px;
      color: rgba(234,240,255,.7);
      font-size:14px;
    }
    .footGrid{display:grid;grid-template-columns:1.2fr .8fr;gap:18px;align-items:start}
    .footLinks{display:flex;gap:12px;flex-wrap:wrap;justify-content:flex-end}
    .footLinks a{padding:8px 10px;border-radius:12px;border:1px solid transparent}
    .footLinks a:hover{border-color:var(--border);background:rgba(255,255,255,.04);color:var(--text)}

    /* Mini state */
    .state{
      border:1px dashed rgba(255,255,255,.18);
      background: rgba(255,255,255,.03);
      border-radius: 16px;
      padding:14px;
      color: var(--muted);
      font-size:14px;
    }

    /* Responsive */
    @media (max-width: 980px){
      .heroGrid{grid-template-columns:1fr}
      .grid{grid-template-columns:repeat(2, minmax(0,1fr))}
      .footGrid{grid-template-columns:1fr}
      .footLinks{justify-content:flex-start}
      .row{grid-template-columns:1fr}
    }
    @media (max-width: 640px){
      .grid{grid-template-columns:1fr}
      .nav{gap:10px}
      .navlinks a{padding:9px 10px}
    }
  </style>
</head>

<body>
  <header class="topbar">
    <div class="container">
      <div class="nav">
        <a class="brand" href="#home" aria-label="Startseite">
          <div class="logo" aria-hidden="true" id="brandLogo"></div>
          <span id="brandTitle">FREE HUB</span>
          <span class="pill" id="brandPill">Downloads</span>
        </a>

        <nav class="navlinks" aria-label="Hauptnavigation">
          <a class="active" href="#home">Home</a>
          <a href="#downloads">Downloads</a>
          <a href="#faq">FAQ</a>
          <a href="#kontakt">Kontakt</a>
          <a href="/admin/" title="Dashboard">Dashboard</a>
        </nav>
      </div>
    </div>
  </header>

  <main id="home">
    <section class="hero">
      <div class="container">
        <div class="heroGrid">
          <div class="heroCard">
            <div class="heroInner">
              <h1 class="hTitle">
                <b>Kostenlose</b> <span class="glow">Downloads</span><br/>
                √ºbersichtlich gelistet
              </h1>
              <p class="hSub" id="heroText">
                Modernes Dark-Design als <b>Free Library</b>: Karten, Suche, Kategorien und FAQ.
                Du kannst die Eintr√§ge im <b>Dashboard</b> hinzuf√ºgen und bearbeiten.
              </p>

              <div class="heroActions">
                <a class="btn primary" href="#downloads">Jetzt st√∂bern</a>
                <a class="btn" href="#faq">FAQ</a>
              </div>

              <div class="heroMeta" id="heroBadges">
                <span class="chip">‚ú® Modernes UI</span>
                <span class="chip">üîé Suche + Filter</span>
                <span class="chip">üì¶ Free Downloads</span>
                <span class="chip">üì± Mobile Ready</span>
              </div>

              <div class="notice" role="note" aria-label="Hinweis">
                <div class="dot" aria-hidden="true"></div>
                <div>
                  <b>Hinweis:</b> Diese Seite ist als Vorlage f√ºr <b>legitime</b> Inhalte gedacht (z. B. Singleplayer/Offline).
                  Online-Cheats/Griefing werden nicht unterst√ºtzt.
                </div>
              </div>
            </div>
          </div>

          <aside class="sideCard" aria-label="Suche und Filter">
            <div class="sideInner">
              <h3 class="sideTitle">Suchen & Filtern</h3>
              <p class="sideText">Finde Eintr√§ge sofort in der √úbersicht.</p>

              <div class="search">
                <span aria-hidden="true">üîé</span>
                <input id="q" type="search" placeholder="Suchen‚Ä¶ z. B. 'preset', 'tool'‚Ä¶" />
              </div>

              <div class="filters">
                <div class="row">
                  <label>
                    <span class="sr-only">Kategorie</span>
                    <select id="cat">
                      <option value="">Kategorie: Alle</option>
                      <option value="singleplayer">Singleplayer</option>
                      <option value="tools">Tools</option>
                      <option value="graphics">Graphics</option>
                      <option value="misc">Misc</option>
                    </select>
                  </label>
                  <label>
                    <span class="sr-only">Sortierung</span>
                    <select id="sort">
                      <option value="new">Sort: Neu zuerst</option>
                      <option value="az">Sort: A‚ÄìZ</option>
                    </select>
                  </label>
                </div>

                <button class="btn small" id="reset" type="button">Zur√ºcksetzen</button>
              </div>

              <div class="hint">
                Tipp: Eintr√§ge verwaltest du unter <b>/admin</b> (Login n√∂tig).
              </div>
            </div>
          </aside>
        </div>
      </div>
    </section>

    <section class="section" id="downloads">
      <div class="container">
        <div class="sectionHead">
          <div>
            <h2>Downloads</h2>
            <p>Karten-Layout (Thumbnail, Kurzinfo, kostenloser Download-Link).</p>
          </div>
          <div class="tabs" role="tablist" aria-label="Ansicht wechseln">
            <button class="btn small tabBtn" role="tab" aria-selected="true" aria-controls="panel-all" id="tab-all" type="button">Alle</button>
            <button class="btn small tabBtn" role="tab" aria-selected="false" aria-controls="panel-featured" id="tab-featured" type="button">Featured</button>
          </div>
        </div>

        <div id="panel-all" class="tabPanel active" role="tabpanel" aria-labelledby="tab-all">
          <div class="grid" id="grid"></div>
          <div id="emptyState" class="state" style="display:none;margin-top:14px;">
            Keine Ergebnisse. √Ñndere Filter oder f√ºge Eintr√§ge im Dashboard hinzu.
          </div>
        </div>

        <div id="panel-featured" class="tabPanel" role="tabpanel" aria-labelledby="tab-featured">
          <div class="grid" id="gridFeatured"></div>
          <div id="emptyFeatured" class="state" style="display:none;margin-top:14px;">
            Keine Featured-Eintr√§ge gesetzt.
          </div>
        </div>
      </div>
    </section>

    <section class="section" id="faq">
      <div class="container">
        <div class="sectionHead">
          <div>
            <h2>FAQ</h2>
            <p>H√§ufige Fragen (Accordion).</p>
          </div>
        </div>

        <div class="faq">
          <details open>
            <summary><span>Wie f√ºge ich Downloads hinzu?</span><i class="caret" aria-hidden="true"></i></summary>
            <p>√ñffne <b>/admin</b>, logge dich ein und lege einen neuen Eintrag an (Titel, Kategorie, Download-Link, Thumbnail).</p>
          </details>
          <details>
            <summary><span>Kann ich Titel und Logo √§ndern?</span><i class="caret" aria-hidden="true"></i></summary>
            <p>Ja ‚Äì im Dashboard gibt es ‚ÄúSite Settings‚Äù. Dort kannst du den Titel, Badge-Text und Logo/URL anpassen.</p>
          </details>
          <details>
            <summary><span>Warum brauche ich ein Dashboard?</span><i class="caret" aria-hidden="true"></i></summary>
            <p>Damit du Inhalte ohne Code pflegen kannst ‚Äì die √Ñnderungen landen automatisch in deinem GitHub-Repo.</p>
          </details>
        </div>
      </div>
    </section>

    <section class="section" id="kontakt">
      <div class="container">
        <div class="sectionHead">
          <div>
            <h2>Kontakt</h2>
            <p>Platzhalter ‚Äì sp√§ter Formular oder Discord-Link.</p>
          </div>
        </div>

        <div class="heroCard" style="box-shadow:0 16px 50px rgba(0,0,0,.35);">
          <div class="heroInner">
            <p style="margin:0 0 10px;color:var(--muted);" id="contactText">
              Hier kannst du Support/Feedback sammeln. Beispiel: Discord-Invite, E-Mail oder Formular.
            </p>
            <div style="display:flex;gap:10px;flex-wrap:wrap;">
              <a class="btn primary" id="contactBtn" href="mailto:kontakt@deine-domain.tld">E-Mail</a>
              <a class="btn" href="#downloads">Zur√ºck zu Downloads</a>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <div class="container">
      <div class="footGrid">
        <div>
          <div style="display:flex;align-items:center;gap:10px;margin-bottom:6px;">
            <div class="logo" aria-hidden="true" id="footLogo"></div>
            <strong id="footTitle">FREE HUB</strong>
            <span class="pill" id="footPill">Darkmode</span>
          </div>
          <div>Impressum ‚Ä¢ Datenschutz ‚Ä¢ Terms</div>
          <div style="margin-top:8px;font-size:13px;">
            Inhalte werden √ºber das Dashboard gepflegt und im GitHub-Repo gespeichert.
          </div>
        </div>
        <div class="footLinks">
          <a href="#home">Home</a>
          <a href="#downloads">Downloads</a>
          <a href="#faq">FAQ</a>
          <a href="#kontakt">Kontakt</a>
          <a href="/admin/">Dashboard</a>
        </div>
      </div>
    </div>
  </footer>

  <script>
    // --- Helpers: frontmatter parsing ---
    function parseFrontmatter(mdText){
      // expects: ---\nYAML\n---\nbody
      const m = mdText.match(/^---\s*[\r\n]+([\s\S]*?)[\r\n]+---\s*[\r\n]+([\s\S]*)$/);
      if(!m) return { data: {}, body: mdText };
      const yamlText = m[1];
      const body = m[2] || "";
      const data = (window.jsyaml && window.jsyaml.load) ? window.jsyaml.load(yamlText) : {};
      return { data: data || {}, body };
    }

    async function loadMarkdown(path){
      const res = await fetch(path, { cache: "no-store" });
      if(!res.ok) throw new Error("Fetch failed: " + path);
      const txt = await res.text();
      return parseFrontmatter(txt);
    }

    // --- UI: tabs ---
    const tabs = [
      {btn: document.getElementById("tab-all"), panel: document.getElementById("panel-all")},
      {btn: document.getElementById("tab-featured"), panel: document.getElementById("panel-featured")}
    ];
    tabs.forEach(({btn, panel}) => {
      btn.addEventListener("click", () => {
        tabs.forEach(t => {
          t.btn.setAttribute("aria-selected", "false");
          t.panel.classList.remove("active");
        });
        btn.setAttribute("aria-selected", "true");
        panel.classList.add("active");
      });
    });

    const grid = document.getElementById("grid");
    const gridFeatured = document.getElementById("gridFeatured");
    const emptyState = document.getElementById("emptyState");
    const emptyFeatured = document.getElementById("emptyFeatured");

    function safeText(s){ return (s ?? "").toString(); }
    function esc(s){
      return safeText(s)
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    function cardTemplate(item){
      const wrap = document.createElement("article");
      wrap.className = "card";
      wrap.dataset.cat = item.category || "";
      wrap.dataset.title = (item.title || "").toLowerCase();
      wrap.dataset.desc = (item.description || "").toLowerCase();

      const thumb = item.thumbnail || "";
      const badge = item.badge || item.category || "Download";
      const download = item.download_url || "#";
      const target = item.new_tab ? "_blank" : "_self";
      const rel = item.new_tab ? "noopener" : "";

      wrap.innerHTML = `
        <div class="thumb">
          ${thumb ? `<img alt="${esc(item.title || "Thumbnail")}" src="${esc(thumb)}" loading="lazy" />` : ``}
          <div class="badge">${esc(badge)}</div>
        </div>
        <div class="cardBody">
          <h3 class="cardTitle">${esc(item.title || "Untitled")}</h3>
          <p class="cardDesc">${esc(item.description || "")}</p>
          <div class="cardActions">
            <a class="btn small primary" href="${esc(download)}" target="${esc(target)}" rel="${esc(rel)}">Download</a>
            ${item.more_info_url ? `<a class="btn small" href="${esc(item.more_info_url)}" target="_blank" rel="noopener">Info</a>` : `<a class="btn small" href="#faq">Info</a>`}
          </div>
        </div>
      `;
      return wrap;
    }

    function render(list){
      grid.innerHTML = "";
      list.forEach(item => grid.appendChild(cardTemplate(item)));
      emptyState.style.display = list.length ? "none" : "block";

      const feat = list.filter(i => !!i.featured);
      gridFeatured.innerHTML = "";
      feat.forEach(item => gridFeatured.appendChild(cardTemplate(item)));
      emptyFeatured.style.display = feat.length ? "none" : "block";
    }

    // Search + filter + sort
    const q = document.getElementById("q");
    const cat = document.getElementById("cat");
    const sort = document.getElementById("sort");
    const reset = document.getElementById("reset");

    let allItems = [];

    function applyFilters(){
      const term = (q.value || "").trim().toLowerCase();
      const c = cat.value;

      let out = allItems.slice();

      if(term){
        out = out.filter(i => (i.title + " " + i.description + " " + (i.badge||i.category||"")).toLowerCase().includes(term));
      }
      if(c){
        out = out.filter(i => (i.category || "") === c);
      }
      if(sort.value === "az"){
        out.sort((a,b) => (a.title||"").localeCompare(b.title||"", "de"));
      }else{
        // newest first by updated
        out.sort((a,b) => (b.updated||"").localeCompare(a.updated||""));
      }
      render(out);
    }

    [q,cat,sort].forEach(el => el.addEventListener("input", applyFilters));
    reset.addEventListener("click", () => {
      q.value=""; cat.value=""; sort.value="new";
      applyFilters();
    });

    // Site settings apply
    function setLogo(el, url){
      if(!el) return;
      el.innerHTML = "";
      if(url){
        const img = document.createElement("img");
        img.src = url;
        img.alt = "Logo";
        el.appendChild(img);
      }
    }

    async function init(){
      // wait for jsyaml
      const t0 = Date.now();
      while(!window.jsyaml && Date.now() - t0 < 3000){
        await new Promise(r => setTimeout(r, 40));
      }

      // load settings
      try{
        const settings = await loadMarkdown("/content/settings.md");
        const s = settings.data || {};
        document.title = s.seo_title || document.title;
        const brandTitle = document.getElementById("brandTitle");
        const footTitle = document.getElementById("footTitle");
        if(s.site_title){ brandTitle.textContent = s.site_title; footTitle.textContent = s.site_title; }

        const brandPill = document.getElementById("brandPill");
        const footPill = document.getElementById("footPill");
        if(s.header_badge){ brandPill.textContent = s.header_badge; }
        if(s.footer_badge){ footPill.textContent = s.footer_badge; }

        if(s.hero_text){ document.getElementById("heroText").innerHTML = s.hero_text; }
        if(s.contact_text){ document.getElementById("contactText").textContent = s.contact_text; }
        if(s.contact_button_text){ document.getElementById("contactBtn").textContent = s.contact_button_text; }
        if(s.contact_email){ document.getElementById("contactBtn").href = "mailto:" + s.contact_email; }

        const logoUrl = s.logo_url || "";
        setLogo(document.getElementById("brandLogo"), logoUrl);
        setLogo(document.getElementById("footLogo"), logoUrl);
      }catch(e){
        // ignore settings failure
        console.warn(e);
      }

      // load downloads
      try{
        const dl = await loadMarkdown("/content/downloads.md");
        const data = dl.data || {};
        allItems = Array.isArray(data.items) ? data.items : [];
      }catch(e){
        console.warn(e);
        allItems = [];
      }

      applyFilters();
    }

    init();
  </script>
</body>
</html>
